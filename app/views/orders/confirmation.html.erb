<% content_for :title, "Order Confirmation - AL Ecommerce" %>

<div class="min-h-screen bg-pink-lightest">
  <%= render "pages/shared/header" %>

  <div class="container mx-auto px-4 py-8">
    <div class="max-w-3xl mx-auto">
      <div class="bg-white rounded-lg border border-pink-border shadow-sm p-8 text-center mb-6">
        <div class="w-16 h-16 bg-green-primary rounded-full flex items-center justify-center mx-auto mb-4">
          <%= render "shared/svg_icons/check", class: "w-8 h-8 text-white" %>
        </div>
        <h1 class="text-3xl font-bold text-green-deep mb-2">Order Confirmed!</h1>
        <p class="text-green-muted">Thank you for your purchase. Your order has been received.</p>
        <div class="mt-4 text-lg font-semibold text-green-primary">Order #<%= @order.id %></div>
      </div>

      <div class="bg-white rounded-lg border border-pink-border shadow-sm p-6 mb-6">
        <h2 class="text-xl font-bold text-green-deep mb-4">Order Details</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
          <div>
            <h3 class="text-sm font-semibold text-green-muted mb-2">Shipping Address</h3>
            <div class="text-green-deep">
              <div class="font-medium"><%= @order.address.full_name %></div>
              <div class="text-sm mt-1">
                <%= @order.address.address_line_1 %><br>
                <% if @order.address.address_line_2.present? %>
                  <%= @order.address.address_line_2 %><br>
                <% end %>
                <%= @order.address.city %>, <%= @order.address.province %> <%= @order.address.postal_code %><br>
                <%= @order.address.phone_number %>
              </div>
            </div>
          </div>

          <div>
            <h3 class="text-sm font-semibold text-green-muted mb-2">Payment Method</h3>
            <div class="text-green-deep">
              <div class="font-medium"><%= @order.payment_method.name %></div>
              <div class="text-sm text-green-muted mt-1"><%= @order.payment_method.code.upcase %></div>
            </div>
          </div>
        </div>

        <div class="border-t border-pink-border pt-4">
          <h3 class="text-sm font-semibold text-green-muted mb-3">Order Items</h3>
          <div class="space-y-3">
            <% @order.order_items.each do |item| %>
              <div class="flex items-start space-x-3">
                <div class="flex-shrink-0">
                  <% if item.product_variant.product.cover_image.attached? %>
                    <%= image_tag item.product_variant.product.cover_image, class: "w-16 h-16 object-cover rounded-lg border border-pink-border" %>
                  <% elsif item.product_variant.product.images.attached? %>
                    <%= image_tag item.product_variant.product.images.first, class: "w-16 h-16 object-cover rounded-lg border border-pink-border" %>
                  <% else %>
                    <div class="w-16 h-16 bg-gradient-to-br from-green-light to-green-primary rounded-lg flex items-center justify-center">
                      <span class="text-white font-bold text-xs"><%= item.product_variant.product.title.first(2).upcase %></span>
                    </div>
                  <% end %>
                </div>
                <div class="flex-1 min-w-0">
                  <div class="font-medium text-green-deep"><%= item.product_variant.product.title %></div>
                  <div class="text-xs text-green-muted"><%= item.product_variant.name %></div>
                  <div class="text-sm text-green-muted mt-1">Qty: <%= item.quantity %></div>
                </div>
                <div class="text-sm font-semibold text-green-deep">
                  $<%= item.subtotal %>
                </div>
              </div>
            <% end %>
          </div>
        </div>

        <div class="border-t border-pink-border pt-4 mt-4">
          <div class="flex justify-between items-center">
            <span class="font-bold text-green-deep">Total Amount</span>
            <span class="font-bold text-green-primary text-xl">$<%= @order.total_amount %></span>
          </div>
        </div>
      </div>

      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <%= link_to "Continue Shopping", products_path, class: "bg-green-primary text-white px-6 py-3 rounded-lg hover:bg-green-dark transition-all duration-200 font-semibold text-center" %>
        <%= link_to "View Orders", "#", class: "bg-white border-2 border-green-primary text-green-primary px-6 py-3 rounded-lg hover:bg-green-light transition-all duration-200 font-semibold text-center" %>
      </div>
    </div>
  </div>

  <%= render "pages/shared/footer" %>
</div>

